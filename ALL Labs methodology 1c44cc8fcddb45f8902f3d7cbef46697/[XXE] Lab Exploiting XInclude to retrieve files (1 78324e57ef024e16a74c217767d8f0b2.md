# [XXE] Lab: Exploiting XInclude to retrieve files (1)

---

![Untitled](%5BXXE%5D%20Lab%20Exploiting%20XInclude%20to%20retrieve%20files%20(1%2078324e57ef024e16a74c217767d8f0b2/Untitled.png)

capture the request from the check stock feature on the site and send it to repeater to allow use to modify and change the request that is being sent to the web server. 

![Untitled](%5BXXE%5D%20Lab%20Exploiting%20XInclude%20to%20retrieve%20files%20(1%2078324e57ef024e16a74c217767d8f0b2/Untitled%201.png)

notice no error here. 

![Untitled](%5BXXE%5D%20Lab%20Exploiting%20XInclude%20to%20retrieve%20files%20(1%2078324e57ef024e16a74c217767d8f0b2/Untitled%202.png)

but we get error here so that must mean that the server is possibly truncating or ignoring what ever is passed after the storeID 

Since the lab mentions Xinclude we cannot use normal method of doing XXE attack here since we do not have access to the XML document to create our own DTD. 

so what we have to do is use Xinclude. 

lets use this payload: 

```jsx
<foo xmlns:xi="http://www.w3.org/2001/XInclude">
<xi:include parse="text" href="file:///etc/passwd"/></foo>
```

here weâ€™re passing a reference to the name space for the Xinclude aswell as including the file we would like to access. 

since earlier we already identified which parameter is vulnerable to any type of injection with only the product ID giving us an error we will need to inject this payload into the productID. 

![Untitled](%5BXXE%5D%20Lab%20Exploiting%20XInclude%20to%20retrieve%20files%20(1%2078324e57ef024e16a74c217767d8f0b2/Untitled%203.png)

**And there we have it:** 

![Untitled](%5BXXE%5D%20Lab%20Exploiting%20XInclude%20to%20retrieve%20files%20(1%2078324e57ef024e16a74c217767d8f0b2/Untitled%204.png)