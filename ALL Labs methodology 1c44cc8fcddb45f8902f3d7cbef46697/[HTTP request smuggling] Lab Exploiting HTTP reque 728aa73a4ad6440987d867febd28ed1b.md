# [HTTP request smuggling] Lab: Exploiting HTTP request smuggling to capture other users' requests (1)

---

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled.png)

possible insertion point: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled%201.png)

lets test for **CL.TE or [TE.CL](http://TE.CL):**

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled%202.png)

we get time out so possible CL.TE

**Lets send one more request to confirm the payload:** 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled%203.png)

we get 200, so this is a CL.TE vulnerability lets now begin to start trying to smuggle in our own request.

so lets take step back and think this through: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled%204.png)

1. I'm going add another comment parameter at the end and leave is null so that the next request is a posted as the comment.

**Lets test:**

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled%205.png)

so I was able play with the content length and set it to size of the prefix weâ€™re expecting plus the original content length: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled%206.png)

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled%207.png)

so 117 for original content length

then prefix of request is: 

 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled%208.png)

990

I need to play with content length some more: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled%209.png)

now lets add few more to content length: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled%2010.png)

got it! 

now lets just add these cookie to our browser with our cookie editor extension: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled%2011.png)

**Lab Solved:** 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20728aa73a4ad6440987d867febd28ed1b/Untitled%2012.png)