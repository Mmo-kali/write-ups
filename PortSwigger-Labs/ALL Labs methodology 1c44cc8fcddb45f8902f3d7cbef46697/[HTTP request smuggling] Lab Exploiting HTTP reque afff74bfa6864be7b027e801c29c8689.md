# [HTTP request smuggling] Lab: Exploiting HTTP request smuggling to reveal front-end request rewriting (1)

---

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20afff74bfa6864be7b027e801c29c8689/Untitled.png)

discovered a point of insertion within the search term: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20afff74bfa6864be7b027e801c29c8689/Untitled%201.png)

test for CL.TE or [TE.CL](http://TE.CL) vulnerabilities: 

invalid request: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20afff74bfa6864be7b027e801c29c8689/Untitled%202.png)

Testing again: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20afff74bfa6864be7b027e801c29c8689/Untitled%203.png)

got a 200 so this is a CL.TE vulnerability. 

lets try to smuggle a request to be able to include the search term to reflect headers being added to the post requests: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20afff74bfa6864be7b027e801c29c8689/Untitled%204.png)

request went through

Changed it up a bit now all we need is to adjust the content-length to show all the added headers:

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20afff74bfa6864be7b027e801c29c8689/Untitled%205.png)

change CL to 200: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20afff74bfa6864be7b027e801c29c8689/Untitled%206.png)

adds a header: `X-tlAXuA-Ip: 207.35.79.66`

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20afff74bfa6864be7b027e801c29c8689/Untitled%207.png)

lets change our IP to 127.0.0.1

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20afff74bfa6864be7b027e801c29c8689/Untitled%208.png)

change search result to equal 1 

**My request:**

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20afff74bfa6864be7b027e801c29c8689/Untitled%209.png)

**The Result:** 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20afff74bfa6864be7b027e801c29c8689/Untitled%2010.png)

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20afff74bfa6864be7b027e801c29c8689/Untitled%2011.png)