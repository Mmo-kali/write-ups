# [HTTP request smuggling] Lab: Exploiting HTTP request smuggling to deliver reflected XSS (1)

---

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20a5127f61114c447db3e5ee3f4d695d77/Untitled.png)

**Test to determine whether it is a [TE.CL](http://TE.CL) or CL.TE :** 

**Payload 1:** 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20a5127f61114c447db3e5ee3f4d695d77/Untitled%201.png)

- Got a 500 Timeout

**Payload 2:** 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20a5127f61114c447db3e5ee3f4d695d77/Untitled%202.png)

- Got a 200

so it is a CL.TE vulnerability now lets create a PoC to get the alert(1) to execute within our own browser before we try to smuggle the request. 

**PoC test:** 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20a5127f61114c447db3e5ee3f4d695d77/Untitled%203.png)

WINT A INPUT TAG WHERE THE VALUE OF USE AGENT IS REFLECTED WHEN REQUEST. 

Lets input a canary to see the reflection: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20a5127f61114c447db3e5ee3f4d695d77/Untitled%204.png)

perfect lets escape this HTML tag and make the script execute alert(1)

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20a5127f61114c447db3e5ee3f4d695d77/Untitled%205.png)

there is no parsing. 

lets use a simple payload: 

`"> <img src=x onerror="alert(1)`

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20a5127f61114c447db3e5ee3f4d695d77/Untitled%206.png)

lets show response in browser: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20a5127f61114c447db3e5ee3f4d695d77/Untitled%207.png)

perfect. 

now lets smuggle this request: 

First remove un-needed headers: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20a5127f61114c447db3e5ee3f4d695d77/Untitled%208.png)

my request: 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20a5127f61114c447db3e5ee3f4d695d77/Untitled%209.png)

**lab solved:** 

![Untitled](%5BHTTP%20request%20smuggling%5D%20Lab%20Exploiting%20HTTP%20reque%20a5127f61114c447db3e5ee3f4d695d77/Untitled%2010.png)