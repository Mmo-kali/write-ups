<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>cherry</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title level-1'>'LAME' HacktheBox</h1><br/><p><h1>HTB </h1><em><h1>&quot;Lame&quot;</h1></em><h1>  Machine Write-Up/Report </h1></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>IP: 10.129.249.9</p><p>HTB link: <em><a href="https://app.hackthebox.com/machines/Lame\">https://app.hackthebox.com/machines/Lame</a></em><a href="https://app.hackthebox.com/machines/Lame\">\</a></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p></p><p> -→ <strong>MICHAEL(Nolkm)</strong></p><p> </p><p> <img src="images/1-1.png" alt="images/1-1.png" /></p></div><div class='page'><h1 class='title level-2'>RECON</h1><br/><p>scanning: </p><p></p><p><img src="images/2-1.png" alt="images/2-1.png" /></p><p></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p></p><p></p><p><img src="images/2-2.png" alt="images/2-2.png" /></p><p></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p></p><p>*** <em><strong><span style="text-decoration:underline;">IMPORTANT</span></strong></em> ***</p><p><ul><li>21/tcp  open  ftp         vsftpd 2.3.4</li></ul></p><p><ul><li>22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)</li></ul></p><p><ul><li>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</li></ul></p><p><ul><li>445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)</li></ul></p><p></p><p></p><p>port 80 filtered </p><p></p></div><div class='page'><h1 class='title level-3'>SMB Enum</h1><br/><p><strong>Resources:</strong> <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-smb">https://book.hacktricks.xyz/network-services-pentesting/pentesting-smb</a></p><p></p><p></p><p><h2>These 2 ports are found to be open on the host system i wll connect with smb clint to see what information i can get: </h2><h2></h2></p><p><h2></h2><ul><li><h2>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</h2></li></ul><h2></h2></p><p><h2></h2><ul><li><h2>445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)</h2></li></ul></p><p></p><p></p><p><img src="images/3-1.png" alt="images/3-1.png" /></p><p><ul><li>NO log File </li></ul></p><p></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p></p><p><strong><h3>enum on smb with enum4linx</h3></strong><strong><h3></h3></strong></p><p><strong><h3></h3></strong><strong><h3></h3></strong></p><p><strong><h3></h3></strong><h3>Command: </h3></p><p><div class="codebox"><pre>─<span style="color:#bf2e5e;font-weight:400">(</span>kali㉿kali<span style="color:#bf2e5e;font-weight:400">)</span>-[~<span style="color:#bf2e5e;font-weight:400">/</span>Desktop<span style="color:#bf2e5e;font-weight:400">/</span>HTB<span style="color:#bf2e5e;font-weight:400">/</span>lame]<br />└─$ enum4linux -a 10.129.249.9 </pre></div><ul><li><em>Shares Found: </em></li></ul></p><p></p><p><img src="images/3-2.png" alt="images/3-2.png" /></p><p></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p></p><p><h3>so we know that it has Samba 3.0.20 running lets look for exploits</h3><ul><li><a href="https://www.exploit-db.com/exploits/16320">https://www.exploit-db.com/exploits/16320</a></li></ul></p><p> exploit with metasploit </p><p> </p><p> </p><p> OK so back to <a href="'LAME'_HacktheBox--Initial_Access--Samba_7.html">Initial_Access </a>phase again </p><p></p><p></p></div><div class='page'><h1 class='title level-3'>SFTP</h1><br/><p><h3>TCP port 21 was open on the target with Service SFTP version (</h3><h3>vsftpd 2.3.4</h3><h3>) </h3><ul><li>   → <h3>   → 21/tcp  open  ftp         vsftpd 2.3.4</h3></li></ul></p><p></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p></p><p></p><p><em><h2>searching for exploit on sftp</h2></em><h2> </h2></p><p></p><p>Found matching exploit with the version of SFTP running </p><p></p><p><img src="images/4-1.png" alt="images/4-1.png" /></p><p></p><p></p><p></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>now lets get into the<strong> </strong><strong><a href="'LAME'_HacktheBox--Initial_Access--SFTP_(BACKDOOR)_6.html">exploit</a></strong> faze </p></div><div class='page'><h1 class='title level-2'>Initial_Access</h1><br/><p>SMB port 139 was a dead end </p><p></p><p></p><p>but port 21 with sftp vsftp2.3.4 was a useful find as there is a know vunerability that allows un-autheticated users get backdoor with command execution </p><p></p></div><div class='page'><h1 class='title level-3'>SFTP (BACKDOOR)</h1><br/><p><em><strong>Recon Node in Cherry -&gt; </strong></em><em><strong><a href="'LAME'_HacktheBox--RECON--SFTP_4.html">sftp_recon</a></strong></em></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p></p><p><h3>TCP port 21 was open on the target with Service SFTP version (</h3><h3>vsftpd 2.3.4</h3><h3>) </h3><ul><li>   → <h3>   → 21/tcp  open  ftp         vsftpd 2.3.4</h3></li></ul></p><p></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p></p><p></p><p></p><p>we found a exploit that is in metasplot so we will be using that </p><p><ul><li>exploitDB link: <a href="https://www.exploit-db.com/exploits/17491">https://www.exploit-db.com/exploits/17491</a></li></ul></p><p><ul><li>→ <em>→ MSFconsole commands </em></li></ul></p><p>→<img src="images/6-1.png" alt="images/6-1.png" /></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>Some type of issue on the first run occured i will try again : </p><p></p><p><img src="images/6-2.png" alt="images/6-2.png" /></p><p></p><p>This seems to be a consisten issue, so this exploit wont work... </p><p></p><p></p></div><div class='page'><h1 class='title level-3'>Samba</h1><br/><p>recon link: <a href="'LAME'_HacktheBox--RECON--SMB_Enum_3.html">SMB enum </a></p><p></p><p>ports 139 and 445 open running samba 3.0.20 </p><p> </p><p> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p></p><p><ul><li><a href="https://www.exploit-db.com/exploits/16320">https://www.exploit-db.com/exploits/16320</a></li></ul></p><p> exploit with metasploit framework </p><p> </p><p> one issue i hadwas i needed to set my LHOST to tun0 the VPN interface... </p><p> [*] Exploit completed, but no session was created.</p><p></p><p></p><p> </p></div><div class='page'><h1 class='title level-2'>Exfiltration</h1><br/><p><h2>was able to get root access using the cve-2007-2447 </h2><h2></h2></p><p><h2></h2><h2></h2></p><p><h2>with remote access and can move accross the machine to collect the keys... </h2></p><p></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p><strong><span style="text-decoration:underline;">Commands with Screen-shots BELOW! </span></strong></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>ip: 10.129.219.127</p><p></p><p><strong><h3>metasploit -&gt; </h3></strong><strong><h3>initial access</h3></strong></p><p><img src="images/8-1.png" alt="images/8-1.png" /></p><p></p><p><em><h3>Now i need to get user flag so lets look at  the directory -&gt; /home</h3></em></p><p></p><p><img src="images/8-2.png" alt="images/8-2.png" /></p><p></p><p>user directory found &#39;makis&#39; </p><p></p><p><strong><h2>USERFLAG.txt</h2></strong></p><p><img src="images/8-3.png" alt="images/8-3.png" /></p><p></p><p></p><p>Now to get root flag we need go into /root directory.... </p><p></p><p><img src="images/8-4.png" alt="images/8-4.png" /></p><p></p><p>Completed: <img src="images/8-5.png" alt="images/8-5.png" /></p></div>
</body>
</html>
